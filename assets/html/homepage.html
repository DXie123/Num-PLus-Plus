<!-- 

    Html Structure 

<span class="mq-editable-field mq-math-mode" id="math-field">
    <span class="mq-textarea"></span>
    <span class="mq-root-block mq-empty" mathquill-block-id="1"></span>
</span>
 -->

<!DOCTYPE html>
<html>
<head>
<title>MathQuill Demo</title>
<link rel="stylesheet" href="./mathquill.css"/>
<style type="text/css">
* {
    margin: 0;
    padding: 0;
}
</style>
<script src="./jquery-3.4.1.min.js"></script>
<script src="./mathquill.min.js"></script>
</head>

<body>

<span id="math-field"></span>

<script>
var MQ = MathQuill.getInterface(2);
var mathFieldSpan = document.getElementById('math-field');

var mathField = MQ.MathField(mathFieldSpan, {
    spaceBehavesLikeTab: true,
    substituteTextarea: function() {
        return document.createElement('span');
    },
});

var mathBlock = document.getElementsByClassName("mq-root-block")[0];
// window.screen.height contains some border pixels
// maybe *0.95
const clientHeight = (window.screen.height-3>0?window.screen.height-3:0);

mathBlock.style.height = clientHeight + "px";
mathBlock.style.fontSize = clientHeight + "px";
mathBlock.style.overflowX = "scroll";
mathBlock.style.backgroundColor = "yellow";

function addCmd(message) {
    mathField.cmd(message);
    mathBlock.style.height = clientHeight + "px";
    mathBlock.style.fontSize = clientHeight + "px";
    while (mathBlock.scrollHeight > clientHeight) {
        var textsize = parseInt(window.getComputedStyle(mathBlock).fontSize) - 5;
        mathBlock.style.fontSize = textsize+"px";
    }
    mathField.focus();
    post();
}

function delString() {
    mathField.keystroke('Backspace');
    mathBlock.style.height = clientHeight + "px";
    mathBlock.style.fontSize = clientHeight + "px";
    while (mathBlock.scrollHeight > clientHeight) {
        var textsize = parseInt(window.getComputedStyle(mathBlock).fontSize) - 5;
        mathBlock.style.fontSize = textsize+"px";
    }
    mathField.focus();
    post();
}

function delAll() {
    mathField.keystroke('Ctrl-A Backspace');
    mathBlock.style.height = clientHeight + "px";
    mathBlock.style.fontSize = clientHeight + "px";
    mathField.focus();
    post();
}

function simulateKey(key) {
    mathField.keystroke(key);
    mathField.focus();
    post();
}

function post() {
    latexString.postMessage(mathField.latex());
}

</script>

</body>
</html>
